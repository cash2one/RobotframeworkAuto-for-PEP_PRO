*** Settings ***
Library           Selenium2Library
Library           DateTime
Library           PepExt.py

*** Variables ***
${PEP_URL}        http://inworktest.yunfangdata.com:82/    # 评E评URL地址
${USER_NAME}      李楠    # 全局用户名
${PASSWORD}       123456    # 登录密码

*** Keywords ***
登录
    打开网页
    Input Text    xpath=//*[@id="username"]    ${USER_NAME}
    Input Text    xpath=//*[@id="password"]    ${PASSWORD}
    click Button    xpath=//button[contains(.,'登录')]
    Wait Until Page Contains    修改密码
    ${用户名}    get text    xpath=.//i[contains(@class,'user-name')]/..
    should Be Equal    ${用户名}    ${USER_NAME}

打开网页
    Open Browser    ${PEP_URL}    chrome
    Maximize Browser Window

等待加载完毕
    Set Selenium Speed    0.5s
    Wait Until Page Contains Element    xpath=//*[@id="LoadingBG" and @style="display: none;"]    timeout=30s
    Wait Until Page Contains Element    xpath=//*[@id="load_Tips" and contains(@style,"display: none")]    timeout=30s

等待列表创建完毕
    Wait Until Page Does Not Contain Element    xpath=//*[@class="datagrid-mask" and contains(@style,"display:block")]    timeout=30s

等待提示框出现
    Wait Until Page Contains Element    xpath=.//div[contains(@class,"messager-window") and contains(@style,"display: block")]    60s

等待弹出窗口出现
    Wait Until Page Contains Element    xpath=//*[contains(@id,'xubox_iframe')]    60s
    select Frame    xpath=//iframe[contains(@id,"xubox_iframe")]

打开功能模块
    [Arguments]    ${主模块}    ${子模块}
    Set Selenium Speed    0.5s
    ${count}    Get Matching Xpath Count    //span[contains(.,'${主模块}')]/../span[@class="arrow down"]
    Run Keyword If    '${count}'=='1'    Click Element    xpath=//span[contains(.,'${主模块}')]
    Wait Until Page Does Not Contain Element    xpath=.//ul[@class="menu" and @style="display: none;"]//a[text()="${子模块}"]    timeout=10s
    Click Element    //a[contains(.,'${子模块}')]

关闭功能模块
    [Arguments]    ${模块名称}
    Click Element    xpath=.//*[@id='framecenter']/div[@class="l-tab-links"]//a[text()="${模块名称}"]/../div[@class="l-tab-links-item-close"]

文本框清空并输入
    [Arguments]    ${locator}    ${text}
    Clear Element Text    xpath=${locator}
    Input Text    xpath=${locator}    ${text}
    log    ${text}

点击提示框中的${button_name}按钮
    Click Element    xpath=//div[contains(@class,"messager-window")]//span[text()="${button_name}"]/ancestor::a

获取当前时间
    [Arguments]    ${format}=%Y%m%d%H%M%S%f
    [Documentation]    根据输入的格式返回指定格式的时间，默认格式为%Y%m%d%H%M%S%f
    ${time}    Get Current Date    result_format=${format}
    [Return]    ${time}

切换到${sub_model_name}子模块
    Click Element    xpath=.//span[text()="${sub_model_name}"]/ancestor::a

页数
    [Arguments]    ${总共多少条[0]}    ${列表数目显示模式}
    ${页数}    Evaluate    ${总共多少条[0]}/${列表数目显示模式}
