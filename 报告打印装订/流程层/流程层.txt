*** Settings ***
Library           Selenium2Library
Library           re
Resource          ../组件层/报告装订打印.txt
Resource          ../../公共模块.txt
Resource          ../元素层/元素层.txt

*** Keywords ***
正确数据查询
    [Arguments]    ${查询类型}    ${流水号}    ${报告号}    ${项目地址}    ${小区名称}
    登录
    打开功能模块    我的项目    报告打印装订
    报告装订打印窗口
    等待列表创建完毕
    ${总数据量}    获取页面显示总数据量
    根据查询条件选择查询类型    ${查询类型}    ${流水号}    ${报告号}    ${项目地址}    ${小区名称}
    Comment    输入流水号    ${流水号}
    点击查询按钮
    等待列表创建完毕
    ${获取报告打印第一页行数}    获取报告装订打印查询数据行数
    ${获取报告打印第一页列数}    获取报告装订打印查询数据列数
    查询结果检测    ${获取报告打印第一页行数}    ${获取报告打印第一页列数}    ${流水号}    流水号
    [Return]    ${总数据量}

错误特殊字符查询
    [Arguments]    ${查询类型}    ${流水号}    ${报告号}    ${项目地址}    ${小区名称}
    清空输入框装订流水号
    等待列表创建完毕
    根据查询条件选择查询类型    ${查询类型}    ${流水号}    ${报告号}    ${项目地址}    ${小区名称}
    Comment    输入流水号    ${流水号}
    ${提示语}    get text    xpath=html/body/div[2]/div[1]
    特殊字符校验提示语    ${查询类型}    ${提示语}    ${流水号}    ${报告号}    ${项目地址}    ${小区名称}
    Comment    should be equal    ${提示语}    请输入正确流水号
    点击查询按钮
    等待列表创建完毕

为空查询
    [Arguments]    ${查询类型}    ${总数据量}    ${流水号}    ${报告号}    ${项目地址}    ${小区名称}
    清空输入框装订流水号
    等待列表创建完毕
    根据查询条件选择查询类型    ${查询类型}    ${流水号}    ${报告号}    ${项目地址}    ${小区名称}
    Comment    输入流水号    ${流水号}
    点击查询按钮
    等待列表创建完毕
    ${新总数}    获取页面显示总数据量
    Should Be Equal    ${新总数}    ${总数据量}

模糊查询
    [Arguments]    ${查询类型}    ${流水号}    ${报告号}    ${项目地址}    ${小区名称}
    清空输入框装订流水号
    等待列表创建完毕
    根据查询条件选择查询类型    ${查询类型}    ${流水号}    ${报告号}    ${项目地址}    ${小区名称}
    Comment    输入流水号    ${流水号}
    点击查询按钮
    等待列表创建完毕
    ${获取报告打印第一页行数}    获取报告装订打印查询数据行数
    ${获取报告打印第一页列数}    获取报告装订打印查询数据列数
    查询结果检测    ${获取报告打印第一页行数}    ${获取报告打印第一页列数}    ${流水号}    流水号

错误查询
    [Arguments]    ${查询类型}    ${总数据量}    ${流水号}    ${报告号}    ${项目地址}    ${小区名称}
    清空输入框装订流水号
    等待列表创建完毕
    根据查询条件选择查询类型    ${查询类型}    ${流水号}    ${报告号}    ${项目地址}    ${小区名称}
    Comment    输入流水号    ${流水号}
    点击查询按钮
    等待列表创建完毕
    ${新总数}    获取页面显示总数据量
    Should Be Equal    ${新总数}    0

超长字符查询
    [Arguments]    ${查询类型}    ${总数据量}    ${流水号}    ${报告号}    ${项目地址}    ${小区名称}
    清空输入框装订流水号
    等待列表创建完毕
    根据查询条件选择查询类型    ${查询类型}    ${流水号}    ${报告号}    ${项目地址}    ${小区名称}
    Comment    输入流水号    ${流水号}
    ${获取输入参数最终值}    获取输入参数最终值    ${查询类型}    ${流水号}    ${报告号}    ${项目地址}    ${小区名称}
    ${n}    Get List Count    ${获取输入参数最终值}
    超长字符校验    ${查询类型}    ${n}    ${流水号}    ${报告号}    ${项目地址}    ${小区名称}
    Comment    超长流水号字符校验    ${n}
