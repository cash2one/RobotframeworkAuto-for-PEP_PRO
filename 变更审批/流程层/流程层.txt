*** Settings ***
Documentation     速度
Library           Selenium2Library
Library           re
Resource          ../组件层/变更审批.txt
Resource          ../../公共模块.txt
Resource          ../元素层/元素层.txt
Resource          ../../变更审批/元素层/元素层.txt

*** Keywords ***
变更审批正确数据查询
    [Arguments]    ${查询类型}    ${流水号}    ${报告号}    ${项目地址}    ${小区名称}
    登录
    ${总数据量}    变更审批打开模块公共方法
    根据查询条件选择查询类型    ${查询类型}    ${流水号}    ${报告号}    ${项目地址}    ${小区名称}
    Comment    输入流水号    ${流水号}
    变更点击查询按钮
    等待列表创建完毕
    ${获取报告打印第一页行数}    获取报告装订打印查询数据行数
    ${获取报告打印第一页列数}    获取报告装订打印查询数据列数
    查询结果检测    ${获取报告打印第一页行数}    ${获取报告打印第一页列数}    ${流水号}    流水号

状态查询
    [Arguments]    ${变更审批状态列表值}    ${路径}
    等待列表创建完毕
    ${总数据量}    获取页面显示总数据量
    Comment    ${总数据量}    报告装订打印打开模块公共方法
    根据变更审批状态选择查询方式    ${变更审批状态列表值}    ${路径}
    变更审批状态    ${变更审批状态列表值}
    变更点击查询按钮
    等待列表创建完毕
    ${总数据量}    获取页面显示总数据量
    ${获取报告打印第一页行数}    获取报告装订打印查询数据行数
    ${获取报告打印第一页列数}    获取报告装订打印查询数据列数
    Comment    Run Keyword If    ${获取报告打印第一页行数}==0    log    查询数据为空，请确保数据库是否有数据    ElSE    查询操作单元结果检测
    ...    ${获取报告打印第一页行数}    ${变更审批状态列表值}    ${路径}
    Run Keyword If    ${获取报告打印第一页行数}!=0    查询操作单元结果检测    ${获取报告打印第一页行数}    ${变更审批状态列表值}    ${路径}
    ...    ELSE    log    查询数据为空，请确保数据库是否有数据
    [Return]    ${总数据量}

变更审批流程
    [Arguments]    ${查询类型}    ${流水号}    ${报告号}    ${项目地址}    ${小区名称}    ${路径}
    等待列表创建完毕
    ${总数据量}    获取页面显示总数据量
    根据查询条件选择查询类型    ${查询类型}    ${流水号}    ${报告号}    ${项目地址}    ${小区名称}    ${路径}
    Comment    输入流水号    ${流水号}
    变更点击查询按钮
    等待列表创建完毕
    ${获取报告打印第一页行数}    获取报告装订打印查询数据行数
    ${获取报告打印第一页列数}    获取报告装订打印查询数据列数
