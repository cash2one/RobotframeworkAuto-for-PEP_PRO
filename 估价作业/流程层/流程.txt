*** Settings ***
Library           Selenium2Library
Resource          ../组件层/公共.txt
Resource          ../组件层/未领取.txt
Resource          ../组件层/进行中.txt
Resource          ../组件层/已完成.txt
Resource          ../../公共模块.txt

*** Keywords ***
线下报告
    [Documentation]    发打发点
    Set Selenium Speed    0.3
    登录
    点击我的项目
    点击估价作业
    Select Frame    id=ProjectAllot_ReportAccept
    等待列表加载完成    1
    点击进行中
    等待列表加载完成    2
    Select From List By Label    //select[@id='OuterStatus']    已完成
    普通查询
    ${pno}    循环获取文本值    //div[@id='tabs']/div[2]/div[2]//div[@class='datagrid-view2']/div[2]//tbody/tr[1]/td[2]/div
    普通查询
    点击线下报告
    点击报告上传
    Unselect Frame
    Select Frame    id=offline_report
    汇总数据新建或编辑
    填写汇总数据    6    云房土地评估项目    为确定估价对象抵押贷款额度提供参考依据而评估房地产抵押价值    广东省    广州市    增城市
    ...    天天家园    12    12    12    房地产评估项目    北京云房
    ...    北京仁达    中国银行    一年    李文    ${USER_NAME}    李伟
    ...    微微    直接估算    混合估算    50000    555555    234235
    ...    44444    20160421    234234    23424    123334    12312
    ...    费所得到的    程序徐翠翠是多少方法    234234    234324    是    水电费加快递费邓丽君手动阀的说法反反复复反复反复反复
    ...    时间段发扣水电费就    手动阀放大顶顶顶顶顶顶顶顶顶顶顶顶顶顶顶顶顶顶顶顶顶顶顶顶顶顶顶顶顶顶顶顶顶顶顶顶顶顶顶顶大地的    钢筋结构    90    12    13
    ...    12/13    士大夫的    23423sdfsdsd234234    米兰    200    商用住宅
    ...    精装    商品房    70    69    ${USER_NAME}    手动阀
    ...    出让    100    234234sdsdf    dssd324    89    24234gsdsdg
    ...    双方都大幅度发方法    李文    440892993423242341    A级    9527    经办单位
    点击保存
    等待确定窗口弹出
    点击确定
    切换选项卡    估价作业
    Select Frame    id=ProjectAllot_ReportAccept
    点击提交
    提交审核    ${pno}
    [Teardown]    Close Browser

线上报告
    Set Selenium Speed    0.3
    登录
    点击我的项目
    点击估价作业
    Select Frame    id=ProjectAllot_ReportAccept
    等待列表加载完成    1
    ${status}    Run Keyword And Return Status    Page Should Contain Element    //div[@id='tabs']/div[2]/div[1]//div[@class='datagrid-view1']/div[2]//tbody/tr[1]/td/div/a[text()='领取']    不存在领取按钮
    Run Keyword If    ${status}==True    操作    1    领取
    点击进行中
    等待列表加载完成    2
    Select From List By Label    //select[@id='OuterStatus']    已完成
    普通查询
    ${pno}    循环获取文本值    //div[@id='tabs']/div[2]/div[2]//div[@class='datagrid-view2']/div[2]//tbody/tr[1]/td[2]/div
    Comment    Wait Until Element Is Visible    //div[@id='tabs']/div[2]/div[2]//div[@class='datagrid-view2']/div[2]//tbody/tr[1]/td[2]/div    10
    Comment    ${pno}    获取列表中各列的值    2    2
    生成线上报告
    点击提交
    提交审核    ${pno}

查看
    Set Selenium Speed    0.3
    登录
    点击我的项目
    点击估价作业
    Select Frame    id=ProjectAllot_ReportAccept
    点击进行中
    Run Keyword And Continue On Failure    点击查看

资料补充
    Set Selenium Speed    0.4
    登录
    点击我的项目
    点击估价作业
    Select Frame    id=ProjectAllot_ReportAccept
    点击资料补充
    Page Should Contain    外业资料查看    INFO

重新提交审核
    Set Selenium Speed    0.5
    登录
    点击我的项目
    点击估价作业
    Select Frame    id=ProjectAllot_ReportAccept
    点击已完成
    重新提交审核操作

点击资料补充
    [Arguments]    ${page_index}
    操作    ${page_index}    资料补充

未领取挂起
    Set Selenium Speed    0.3
    登录
    点击我的项目
    点击估价作业
    Select Frame    id=ProjectAllot_ReportAccept
    点击挂起    1
    Page Should Contain Element    //div[@id='tabs']/div[2]/div[1]//div[@class='datagrid-view1']/div[2]//tbody/tr[1]/td/div/a[text()='解挂']

未领取解挂
    Set Selenium Speed    0.3
    登录
    点击我的项目
    点击估价作业
    Select Frame    id=ProjectAllot_ReportAccept
    解除挂起    1
    Page Should Contain Element    //div[@id='tabs']/div[2]/div[1]//div[@class='datagrid-view1']/div[2]//tbody/tr[1]/td/div/a[text()='挂起']

进行中挂起
    Set Selenium Speed    0.3
    登录
    点击我的项目
    点击估价作业
    Select Frame    id=ProjectAllot_ReportAccept
    点击进行中
    等待列表加载完成    2
    点击挂起    2
    Page Should Contain Element    //div[@id='tabs']/div[2]/div[2]//div[@class='datagrid-view1']/div[2]//tbody/tr[1]/td/div/a[text()='解挂']

进行中解挂
    Set Selenium Speed    0.3
    登录
    点击我的项目
    点击估价作业
    Select Frame    id=ProjectAllot_ReportAccept
    点击进行中
    等待列表加载完成    2
    解除挂起    2
    Page Should Contain Element    //div[@id='tabs']/div[2]/div[2]//div[@class='datagrid-view1']/div[2]//tbody/tr[1]/td/div/a[text()='挂起']

基本信息校验
    Set Selenium Speed    0.3
    登录
    点击我的项目
    点击估价作业
    Select Frame    id=ProjectAllot_ReportAccept
    等待列表加载完成    1
    点击一条记录    1
    ${流水号}    获取列表中各列的值    1    2
    ${报告编号}    获取列表中各列的值    1    3
    ${项目地址}    获取列表中各列的值    1    6
    ${rpno}    Get Text    //label[@id='rpno']
    ${pjno}    Get Text    //label[@id='pjno']
    ${pjaddress}    Get Text    //label[@id='pjaddress']
    Should Be Equal    ${流水号}    ${pjno}
    Should Be Equal    ${报告编号}    ${rpno}
    Should Be Equal    ${项目地址}    ${pjaddress}

流程信息校验
    Set Selenium Speed    0.3
    登录
    点击我的项目
    点击估价作业
    Select Frame    id=ProjectAllot_ReportAccept
    等待列表加载完成    1
    点击一条记录    1
    Click Element    //span[text()='流程跟进']/..
    ${count}    Get Matching Xpath Count    //div[@id='tabsinfo']/div[2]/div[2]//div[@class='datagrid-view2']/div[2]//tr
    : FOR    ${i}    IN RANGE    ${count}
    \    获取流程信息每列的值    ${i}

查询验证
    Set Selenium Speed    0.3
    登录
    点击我的项目
    点击估价作业
    Select Frame    id=ProjectAllot_ReportAccept
    等待列表加载完成    1
    Comment    ${rows}    获取查询条件的行数    //div[@id='toolbarNo']//tbody//tr
    Comment    :FOR    ${i}    in range    ${rows}
    Comment    \    ${row_count}    获取每行的查询条件个数    //div[@id='toolbarNo']//tbody/tr[${i+1}]//td[position() mod 2 = 0 ]
    Comment    \    根据标签名进行查询    ${row_count}    ${i}    //div[@id='toolbarNo']//tbody
    循环获取列表的名称    //div[@id='tabs']/div[2]/div[1]//div[@class='datagrid-view2']/div[1]//table
